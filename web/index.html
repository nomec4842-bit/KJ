<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>KJ – Groovebox</title>
  <link rel="stylesheet" href="style.css"/>
</head>
<body>
  <header>
    <button id="play" class="primary">Play</button>
    <button id="stop" class="ghost">Stop</button>

    <label class="ctrl">
      Tempo
      <input id="tempo" type="number" value="120" min="40" max="300" step="1">
    </label>

    <label class="ctrl">
      Track
      <select id="trackSelect"></select>
    </label>
    <button id="addTrack">+ Track</button>

    <label class="ctrl">
      Engine
      <select id="engine">
        <option value="synth">Synth</option>
        <option value="noise">Noise Synth</option>
        <option value="kick808">808 Kick</option>
        <option value="snare808">808 Snare</option>
        <option value="hat808">808 Hat</option>
        <option value="clap909">909 Clap</option>
        <option value="sampler">Sampler</option>
        <option value="cvl">CVL</option>
      </select>
    </label>

    <label class="ctrl" style="margin-left:12px">
      <input id="togglePiano" type="checkbox">
      Piano Roll
    </label>

    <span style="flex:1"></span>
    <button id="saveProject" class="ghost">Save JSON</button>
    <button id="loadProject" class="ghost">Load JSON</button>
    <input id="loadProjectFile" type="file" accept="application/json" hidden>
    <button id="resetProject" class="ghost">Reset</button>
  </header>

  <main>
    <section class="panel" id="timelinePanel">
      <h3>Timeline</h3>
      <div id="sequencer"></div>
      <div id="arpPanel" class="arp-panel is-hidden"></div>
      <div id="pianoNoteParams" class="step-detail piano-note-params placeholder">
        <span class="hint">Select a piano roll note to edit velocity, chance, and length.</span>
      </div>
    </section>

    <section class="panel cvl-panel is-hidden" id="cvlPanel">
      <h3>Timeline</h3>
      <div id="cvlRoot"></div>
    </section>

    <section class="panel">
      <h3>Track Mixer & Params</h3>
      <div id="params"></div>
    </section>

    <section class="panel">
      <h3>Chain</h3>
      <div style="display:flex;flex-wrap:wrap;gap:8px;align-items:center;margin-bottom:8px">
        <label class="ctrl">
          Pattern
          <select id="patternSelect"></select>
        </label>
        <button id="addPattern">+ Pattern</button>
        <button id="dupPattern">Duplicate</button>
        <label class="ctrl">
          Len (16ths)
          <input id="patLen" type="number" value="16" min="4" max="512" step="1" style="width:72px">
        </label>
        <button id="chainAdd">Chain ⤴︎</button>
        <label class="ctrl">
          <input id="followChain" type="checkbox">
          Follow Chain
        </label>
      </div>
      <div id="chainView" style="display:flex;flex-wrap:wrap;gap:6px"></div>
      <div style="margin-top:8px;display:flex;gap:8px;align-items:center">
        <button id="chainClear" class="ghost">Clear Chain</button>
        <button id="chainPrev">◀ Prev</button>
        <button id="chainNext">Next ▶</button>
        <label class="ctrl">
          <input id="loopChain" type="checkbox">
          Loop Chain
        </label>
        <span id="chainStatus" class="hint"></span>
      </div>
    </section>
  </main>

  <script type="module" src="main.js"></script>
</body>
</html>
